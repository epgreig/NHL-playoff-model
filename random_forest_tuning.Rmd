---
title: "benchmark_tuning.Rmd"
author: "Ethan Greig"
date: "1/20/2019"
output: html_document
---

```{r}
library(knitr)
source(purl('import_and_generate_series.Rmd', output = tempfile()))
# Note that only data from 2008-2017 is imported here. 2018 data is kept as a holdout set
```

## Hyperparameter Tuning on RF model
```{r}
# Grid Search using randomForest's built in OOB error (not cross-validated Log Loss)
# Using classification because regression does not track OOB err.rate

rf_grid <- function(data, mtrys, nodesizes, ntrees=4000) {
  results <- matrix(nrow=length(mtrys), ncol=length(nodesizes))
  
  for (i in mtrys) {
    for (j in nodesizes) {
      set.seed(1)
      temp_model <- randomForest(`Home_Won` ~ ., data=data, ntree=ntrees, mtry=i, nodesize=j)
      results[i-min(mtrys)+1,j-min(nodesizes)+1] <- temp_model$err.rate[ntrees,1]
    }
    print(i)
  }
  
  rownames(results) <- paste('mtry', mtrys, sep='=')
  colnames(results) <- paste('nodesize', nodesizes, sep='=')
  write.table(results, file="~/repos/nhl-playoff-model/output_csvs/grid_search_random_forest.csv", sep=',', col.names=NA)
}
```